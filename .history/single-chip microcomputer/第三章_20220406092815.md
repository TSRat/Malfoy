# 第三章
* **引脚**
![](../images/80C51.png)
  * RST/VPD（9）
    * RST：复位端，高电平有效，单片机运行时在此加入大于两个机器周期的高电平，就可以复位
    * VPD：备用电   源输入端，当主电源VCC发生故障，将自动接入，保证RAM信息不丢失
![](../images/RESET.png)按下S22，VCC接通，VRST=5×（10/11）V，达到高电平要求
上电自动复位：通电时CJ3两端产生电压，达到高电平；充完电后通过10K电阻放电
  * P3.0-P3.7（10-17）：有第二功能，需要设置
    * RXD：串行输入口（与计算机连接）
    * PXD：串行输出口（与计算机连接）
    * 开机后先启动（冷启动），计算机输入程序，若没有，则执行原来程序
    * INT0/1：外部中断0/1
    * T0/1：定时器0/1或外部计数输入
    * WR：外部数据存储器的协选通
    * RD：外部数据存储器的主选通
  * XTAL2/1（18-19）：晶振输入端
![](../images/晶振.png)
C4、C5：起振
  * VSS（20）：接地
  * PSEN（29）：低电平有效，用于扩展外部ROM
  * ALE/PROG（30）
    * ALE：输出六分之一的时钟脉冲，以检测单片机是否工作，可作为外部时钟或定时脉冲使用
    * PROG：编程脉冲的输入端
  * EA/VPP（31）
    * EA：高电平时，单片机先读取内部程序存储器再读取外部；低电平时直接读取外部ROM 
    * VPP：编程用
  * VCC（40）：接电源
  * I/O口：P0、1、2、3
    * P0：双向8位三态，有高阻状态
    * P1、2、3：准双向，有上拉电阻，输入数据时需要先写1
* **数码管显示字符**
  * **显示器及其接口**
    * 单片机系统中常用的显示器有：发光二极管LED（Light Emitting Diode）显示器、液晶LCD(Liquid Crystal Display) 显示器、CRT显示器（输出模拟信号）等；LED、LCD显示器有两种显示结构：段显示（7段、米字型等）和点阵显示(5X8、8X8点阵等)
![](../images/数码管.png)
![](../images/数码管码表.png)
  * **LED数码显示方式及电路**
    * **静态显示方式**：每个数码管的段选必须接一个8位数据线来**保持显示的字形码**，当送入一次字形码后，显示字形可一直保持，直到送入新字形码为止；这种方法的优点是占用CPU时间少，显示便于监测和控制，缺点是硬件电路比较复杂，成本较高
      * 如果进行操作使所有数码管同时点亮，由于数码管段选段是串联在一起的，所以同一时刻这些数码管只能显示同样的数字
![](../images/静态显示.png)
C0、2、3、4：位选，控制哪一个数码管亮，由P2控制
a\b\c\d\e\f\g\h：段选，控制哪一段亮，由P0控制
R：上拉电阻，加大输入电流（I/O口电流不足以点亮）
    * **动态显示方式**：如果想要控制多个数码管**显示不同的数字**，需要进行动态点亮；将所有位数码管的段选线并联在一起，由位选线控制是哪一位数码管有效；选亮数码管采用**动态扫描显示**，所谓动态扫描显示即轮流向各位数码管送出字形码和相应的位选，利用发光管的余辉和人眼视觉暂留作用（24ms），使人的感觉好像各位数码管同时都在显示；动态显示的亮度比静态显示要差一些，所以在选择限流电阻时应略小于静态显示电路中的
![](../images/数码管2.png)
74HC345：锁存器，DIR接高电平则A输入B输出，低电平则B输入A输出；OE为使能端   
![](../images/译码器.png)
74HC138：3线8位译码器，A、B、C输入；三个使能端，除非G2A和G2B2置低且G1置高，否则74HC138将保持所有输出为高
![](../images/74HC138.jpg)
```
#include "reg52.h" //此文件中定义了单片机的一些特殊功能
typedef unsigned int u16; //对数据类型进行声明定义
typedef unsigned char u8;
sbit LSA=P2^2;//译码器输入端A
sbit LSB=P2^3;//B
sbit LSC=P2^4;//C
u8 code smgduan[17]={0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,
0x7f,0x6f,0x77,0x7c,0x39,0x5e,0x79,0x71};// 显示0~F的值
void main(){
	while(1){
	DigDisplay(); //数码管显示函数
  }
}
/
* 函 数 名 : delay
* 函数功能 : 延时函数，i=1 时，大约延时 10us
/
void delay(u16 i)
{
while(i--);
}
/
* 函 数 名 : DigDisplay
* 函数功能 : 数码管动态扫描函数，循环扫描 8 个数码管显示01234567
/
void DigDisplay()
{
u8 i;
for(i=0;i<8;i++)
  {
    switch(i) //位选，选择点亮的数码管
    {
      case(0):
      LSA=1;LSB=1;LSC=1; break;//显示第 0 位
      case(1):
      LSA=0;LSB=1;LSC=1; break;//显示第 1 位
      case(2):
      LSA=1;LSB=0;LSC=1; break;//显示第 2 位
      case(3):
      LSA=0;LSB=0;LSC=1; break;//显示第 3 位
      case(4):
      LSA=1;LSB=1;LSC=0; break;//显示第 4 位
      case(5):
      LSA=0;LSB=1;LSC=0; break;//显示第 5 位
      case(6):
      LSA=1;LSB=0;LSC=0; break;//显示第 6 位
      case(7):
      LSA=0;LSB=0;LSC=0; break;//显示第 7 位
    }
    P0=smgduan[i];//发送段码
    delay(100); //间隔一段时间扫描
    P0=0x00;//消隐
  }
}
void main(){
	while(1){
	DigDisplay(); //数码管显示函数
  }
}
```